<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transaction Contract UI</title>
    <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js/dist/web3.min.js"></script>
</head>
<body>
    <h1>Transaction Contract Interface</h1>

    <!-- Connect to MetaMask -->
    <button id="connect">Connect Wallet</button>
    <p id="account"></p>

    <!-- Add Funds -->
    <h2>Add Funds</h2>
    <input type="number" id="fundAmount" placeholder="Enter amount in Ether">
    <button id="addFunds">Add Funds</button>

    <!-- Check Balance -->
    <h2>Check Balance</h2>
    <input type="text" id="balanceAccount" placeholder="Enter account address">
    <button id="checkBalance">Check Balance</button>
    <p id="balance"></p>

    <!-- Withdraw -->
    <h2>Withdraw</h2>
    <input type="number" id="withdrawAmount" placeholder="Enter amount to withdraw">
    <button id="withdraw">Withdraw</button>

    <!-- Schedule Withdrawal -->
    <h2>Schedule Withdrawal</h2>
    <input type="number" id="scheduleWithdrawAmount" placeholder="Enter amount in Ether">
    <input type="number" id="withdrawTimePeriod" placeholder="Time period in seconds">
    <button id="scheduleWithdraw">Schedule Withdrawal</button>

    <!-- Cancel Scheduled Withdrawal -->
    <h2>Cancel Scheduled Withdrawal</h2>
    <input type="number" id="cancelWithdrawIndex" placeholder="Enter index of withdrawal">
    <button id="cancelWithdraw">Cancel Scheduled Withdrawal</button>

    <!-- Execute Scheduled Withdrawal -->
    <h2>Execute Scheduled Withdrawal</h2>
    <input type="number" id="executeWithdrawIndex" placeholder="Enter index of withdrawal">
    <button id="executeWithdraw">Execute Scheduled Withdrawal</button>

    <!-- Instant Transfer -->
    <h2>Instant Transfer</h2>
    <input type="text" id="transferTo" placeholder="Recipient address">
    <input type="number" id="transferAmount" placeholder="Enter amount in Ether">
    <button id="instantTransfer">Transfer Now</button>

    <!-- Schedule Transfer -->
    <h2>Schedule Transfer</h2>
    <input type="text" id="scheduleTransferTo" placeholder="Recipient address">
    <input type="number" id="scheduleTransferAmount" placeholder="Enter amount in Ether">
    <input type="number" id="transferTimePeriod" placeholder="Time period in seconds">
    <button id="scheduleTransfer">Schedule Transfer</button>

    <!-- Cancel Scheduled Transfer -->
    <h2>Cancel Scheduled Transfer</h2>
    <input type="number" id="cancelTransferIndex" placeholder="Enter index of transfer">
    <button id="cancelTransfer">Cancel Scheduled Transfer</button>

    <!-- Execute Scheduled Transfer -->
    <h2>Execute Scheduled Transfer</h2>
    <input type="number" id="executeTransferIndex" placeholder="Enter index of transfer">
    <button id="executeTransfer">Execute Scheduled Transfer</button>

    <!-- Add Child Account -->
    <h2>Add Child Account</h2>
    <input type="text" id="childAddress" placeholder="Child account address">
    <button id="addChild">Add Child Account</button>

    <script>
        let web3;
        let contract;
        const contractAddress = '0x5B38Da6a701c568545dCfcB03FcB875f56beddC4'; // Replace with your deployed contract address
        const abi = [0x5B38Da6a701c568545dCfcB03FcB875f56beddC4]; // Paste your contract's ABI here

        window.onload = async () => {
            if (window.ethereum) {
                web3 = new Web3(window.ethereum);
                try {
                    await window.ethereum.enable();
                } catch (error) {
                    console.error("User denied account access");
                }
                contract = new web3.eth.Contract(abi, contractAddress);
            } else {
                console.log("Non-Ethereum browser detected. You should consider trying MetaMask!");
            }
        };

        // Connect MetaMask
        document.getElementById('connect').onclick = async () => {
            const accounts = await web3.eth.getAccounts();
            document.getElementById('account').innerText = `Connected: ${accounts[0]}`;
        };

        // Add Funds
        document.getElementById('addFunds').onclick = async () => {
            const accounts = await web3.eth.getAccounts();
            const amount = document.getElementById('fundAmount').value;
            await contract.methods.addFunds(web3.utils.toWei(amount, "ether")).send({ from: accounts[0], value: web3.utils.toWei(amount, "ether") });
        };

        // Check Balance
        document.getElementById('checkBalance').onclick = async () => {
            const account = document.getElementById('balanceAccount').value;
            const balance = await contract.methods.checkBalance(account).call();
            document.getElementById('balance').innerText = `Balance: ${web3.utils.fromWei(balance, "ether")} Ether`;
        };

        // Withdraw
        document.getElementById('withdraw').onclick = async () => {
            const accounts = await web3.eth.getAccounts();
            const amount = document.getElementById('withdrawAmount').value;
            await contract.methods.withdraw(web3.utils.toWei(amount, "ether")).send({ from: accounts[0] });
        };

        // Schedule Withdrawal
        document.getElementById('scheduleWithdraw').onclick = async () => {
            const accounts = await web3.eth.getAccounts();
            const amount = document.getElementById('scheduleWithdrawAmount').value;
            const timePeriod = document.getElementById('withdrawTimePeriod').value;
            await contract.methods.addScheduleWithdraw(web3.utils.toWei(amount, "ether"), timePeriod).send({ from: accounts[0] });
        };

        // Cancel Scheduled Withdrawal
        document.getElementById('cancelWithdraw').onclick = async () => {
            const accounts = await web3.eth.getAccounts();
            const index = document.getElementById('cancelWithdrawIndex').value;
            await contract.methods.cancelScheduleWithdraw(index).send({ from: accounts[0] });
        };

        // Execute Scheduled Withdrawal
        document.getElementById('executeWithdraw').onclick = async () => {
            const accounts = await web3.eth.getAccounts();
            const index = document.getElementById('executeWithdrawIndex').value;
            await contract.methods.executeScheduledWithdraw(index).send({ from: accounts[0] });
        };

        // Instant Transfer
        document.getElementById('instantTransfer').onclick = async () => {
            const accounts = await web3.eth.getAccounts();
            const to = document.getElementById('transferTo').value;
            const amount = document.getElementById('transferAmount').value;
            await contract.methods.instantTransfer(to, web3.utils.toWei(amount, "ether")).send({ from: accounts[0] });
        };

        // Schedule Transfer
        document.getElementById('scheduleTransfer').onclick = async () => {
            const accounts = await web3.eth.getAccounts();
            const to = document.getElementById('scheduleTransferTo').value;
            const amount = document.getElementById('scheduleTransferAmount').value;
            const timePeriod = document.getElementById('transferTimePeriod').value;
            await contract.methods.scheduleTransfer(to, web3.utils.toWei(amount, "ether"), timePeriod).send({ from: accounts[0] });
        };

        // Cancel Scheduled Transfer
        document.getElementById('cancelTransfer').onclick = async () => {
            const accounts = await web3.eth.getAccounts();
            const index = document.getElementById('cancelTransferIndex').value;
            await contract.methods.cancelScheduledTransfer(index).send({ from: accounts[0] });
        };

        // Execute Scheduled Transfer
        document.getElementById('executeTransfer').onclick = async () => {
            const accounts = await web3.eth.getAccounts();
            const index = document.getElementById('executeTransferIndex').value;
            await contract.methods.executeScheduledTransfer(index).send({ from: accounts[0] });
        };

        // Add Child Account
        document.getElementById('addChild').onclick = async () => {
            const accounts = await web3.eth.getAccounts();
            const child = document.getElementById('childAddress').value;
            await contract.methods.addChildAccount(child).send({ from: accounts[0] });
        };
    </script>
</body>
</html>
